@page "/tenant/dashboard"
@attribute [Authorize]

<PageTitle>My Dashboard - TentMan</PageTitle>

<BusyBoundary Retry="LoadDataAsync">
    <MudStack Spacing="4">
        <MudText Typo="Typo.h4">My Tenant Dashboard</MudText>

        @if (_activeLease != null)
        {
            <MudPaper Elevation="2" Class="pa-4">
                <MudStack Spacing="3">
                    <MudStack Row="true" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Center">
                        <MudText Typo="Typo.h5">My Active Lease</MudText>
                        <MudChip T="string" Color="Color.Success" Size="Size.Small">Active</MudChip>
                    </MudStack>

                    <MudDivider />

                    <MudGrid Spacing="3">
                        <MudItem xs="12" sm="6" md="4">
                            <MudStack Spacing="1">
                                <MudText Typo="Typo.caption" Color="Color.Secondary">Lease Number</MudText>
                                <MudText Typo="Typo.body1">@_activeLease.LeaseNumber</MudText>
                            </MudStack>
                        </MudItem>
                        <MudItem xs="12" sm="6" md="4">
                            <MudStack Spacing="1">
                                <MudText Typo="Typo.caption" Color="Color.Secondary">Start Date</MudText>
                                <MudText Typo="Typo.body1">@_activeLease.StartDate.ToString("dd MMM yyyy")</MudText>
                            </MudStack>
                        </MudItem>
                        <MudItem xs="12" sm="6" md="4">
                            <MudStack Spacing="1">
                                <MudText Typo="Typo.caption" Color="Color.Secondary">End Date</MudText>
                                <MudText Typo="Typo.body1">@(_activeLease.EndDate?.ToString("dd MMM yyyy") ?? "Open-ended")</MudText>
                            </MudStack>
                        </MudItem>
                        <MudItem xs="12" sm="6" md="4">
                            <MudStack Spacing="1">
                                <MudText Typo="Typo.caption" Color="Color.Secondary">Monthly Rent</MudText>
                                <MudText Typo="Typo.h6" Color="Color.Primary">₹@_activeLease.MonthlyRent.ToString("N0")</MudText>
                            </MudStack>
                        </MudItem>
                        <MudItem xs="12" sm="6" md="4">
                            <MudStack Spacing="1">
                                <MudText Typo="Typo.caption" Color="Color.Secondary">Security Deposit</MudText>
                                <MudText Typo="Typo.body1">₹@_activeLease.SecurityDeposit.ToString("N0")</MudText>
                            </MudStack>
                        </MudItem>
                        <MudItem xs="12" sm="6" md="4">
                            <MudStack Spacing="1">
                                <MudText Typo="Typo.caption" Color="Color.Secondary">Rent Due Day</MudText>
                                <MudText Typo="Typo.body1">@_activeLease.RentDueDay of each month</MudText>
                            </MudStack>
                        </MudItem>
                    </MudGrid>
                </MudStack>
            </MudPaper>

            <MudPaper Elevation="2" Class="pa-4">
                <MudStack Spacing="3">
                    <MudText Typo="Typo.h6">Unit Details</MudText>
                    <MudDivider />
                    <MudGrid Spacing="3">
                        <MudItem xs="12" sm="6">
                            <MudStack Spacing="1">
                                <MudText Typo="Typo.caption" Color="Color.Secondary">Unit Number</MudText>
                                <MudText Typo="Typo.body1">@_activeLease.UnitNumber</MudText>
                            </MudStack>
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudStack Spacing="1">
                                <MudText Typo="Typo.caption" Color="Color.Secondary">Building</MudText>
                                <MudText Typo="Typo.body1">@_activeLease.BuildingName</MudText>
                            </MudStack>
                        </MudItem>
                    </MudGrid>
                </MudStack>
            </MudPaper>
        }
        else
        {
            <MudPaper Elevation="2" Class="pa-6">
                <MudStack AlignItems="AlignItems.Center" Spacing="3">
                    <MudIcon Icon="@Icons.Material.Filled.Info" Size="Size.Large" Color="Color.Info" />
                    <MudText Typo="Typo.h6">No Active Lease</MudText>
                    <MudText Typo="Typo.body1" Align="Align.Center">
                        You don't have an active lease at the moment.
                    </MudText>
                </MudStack>
            </MudPaper>
        }

        <MudStack Row="true" Spacing="2">
            <MudButton Variant="Variant.Filled" Color="Color.Primary" Href="/tenant/lease-summary">
                View Lease Details
            </MudButton>
            <MudButton Variant="Variant.Filled" Color="Color.Primary" Href="/tenant/documents">
                My Documents
            </MudButton>
            <MudButton Variant="Variant.Outlined" Color="Color.Primary" Href="/tenant/move-in">
                Move-in Handover
            </MudButton>
        </MudStack>
    </MudStack>
</BusyBoundary>

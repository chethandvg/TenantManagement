@page "/billing/lease-settings"
@page "/billing/lease-settings/{LeaseId:guid}"
@attribute [Authorize]

<PageTitle>Lease Billing Settings</PageTitle>

<MudStack Spacing="4">
    <MudStack Row="true" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Center">
        <MudText Typo="Typo.h4">Lease Billing Settings</MudText>
    </MudStack>

    @if (!LeaseId.HasValue)
    {
        <MudPaper Elevation="2" Class="pa-4">
            <MudText>Please select a lease to manage billing settings.</MudText>
        </MudPaper>
    }
    else
    {
        <BusyBoundary Retry="LoadSettingsAsync">
            @if (_settings != null)
            {
                <MudPaper Elevation="2" Class="pa-4">
                    <MudStack Spacing="3">
                        <MudText Typo="Typo.h6">Billing Configuration</MudText>
                        
                        <MudNumericField T="byte" @bind-Value="_settings.BillingDay" Label="Billing Day (1-28)" 
                                         Min="(byte)1" Max="(byte)28" Required="true" />
                        
                        <MudNumericField T="short" @bind-Value="_settings.PaymentTermDays" Label="Payment Term Days" 
                                         Min="(short)0" Max="(short)365" Required="true" />
                        
                        <MudSwitch T="bool" @bind-Checked="_settings.GenerateInvoiceAutomatically" 
                                   Label="Auto-Generate Invoices" Color="Color.Primary" />
                        
                        <MudTextField @bind-Value="_settings.InvoicePrefix" Label="Invoice Prefix" 
                                      MaxLength="50" />
                        
                        <MudTextField @bind-Value="_settings.PaymentInstructions" Label="Payment Instructions" 
                                      Lines="3" MaxLength="1000" />
                        
                        <MudTextField @bind-Value="_settings.Notes" Label="Notes" 
                                      Lines="3" MaxLength="2000" />
                        
                        <MudButton Variant="Variant.Filled" Color="Color.Primary" 
                                   StartIcon="@Icons.Material.Filled.Save"
                                   OnClick="SaveSettingsAsync">
                            Save Settings
                        </MudButton>
                    </MudStack>
                </MudPaper>
            }
        </BusyBoundary>
    }
</MudStack>
